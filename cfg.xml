<?xml version="1.0" ?>
<root name="root">
	<srcDir val = "..//dataset//gpmAnalysis//3//" />

	<focusedImgs num = "1" >
		<focuedPrefix val = "004" />
		<focuedPrefix val = "105" />
	</focusedImgs>

	<gpmStep>
		<enabled val = "1" />
		<subDir val = "" />
	</gpmStep>

	<voteStep>
		<enabled val = "1" />
		<subDir val = "01_PredictParam//" />
	</voteStep>

	<detectionStep>
		<enabled val = "1" />
		<subDir val = "02_VoteDetection//" />
		
		<mrfSmooth>
			<enabled val = "1" />
			<nLabels val = "32" />
			<nChannels val = "1" />
			<smoothTerm>
				<colorSigma val = "0.2" />
				<weight val = "2" />
			</smoothTerm>
		</mrfSmooth>
		
		<analysis>
			<hist>
				<histN val = "64" />
				<histMinV val = "0.1" />
				<adjacentRatio val = "1.0" />
			</hist>
			<cellFilter>
				<shadowDegreeThres val = "200" />
				<pixelNumThres val = "0.2" />
				<boxRatioThres val = "0.2" />
			</cellFilter>
			<cellAdjacentRadiusRatio val = "0.02" />
			<regionPredictor enabled = "0" val = "..//" />
			<TODOtrainingToPredict />
			<mrf>
				<regionAlphaEstimate higherVal = "0.25" />
				<boundaryWidth val = "-1" />
				<nLabels val = "32" />
				<dataTerm guidInitMaxRatio = "1.2" ratioSigma = "0.05" whiteWeight = "10"/>
				<smoothTerm colorSigma = "0.2" weight = "10" />
			</mrf>
		</analysis>
		
		<matting>
			<shdwDegreeThres val = "0.8" />
			<maskErodeTimes val = "5" />
			<maskDilateTimes val = "15" />
			<TODOrefineMattingRemoveAvg />
		</matting>

		<debug>
			<debugResult output = "1" dir = "result//" />
		</debug>
	</detectionStep>

	<recoveryStep>
		<enabled val = "0" />
		<subDir val = "03_VoteRecovery//" />
		
		<naiveRecovery>
			<patchSize val = "1" />
			<resPostfix val = "_naive_res.png" />
		</naiveRecovery>

		<maskGenerate>
			<shdwDegreeThres val = "0.8" />
			<shdwBoundDilateTimes val = "0.01" />
			<holeMaskImgPostfix val = "_syn_hole.png" />
			<legalMaskImgPostfix val = "_syn_legal.png" />
		</maskGenerate>

		<synthesis>
			<patchSize val = "5" />
			<pym>
				<minWidth val = "19.0" valStep2 = "75.0"/>
				<resizeRatio val = "0.5" />
				<cpltItrlN max = "2" min = "2" />
			</pym>
			<gpm>
				<itrlN val = "6" />
				<flipEnabled h = "1" v = "1" />
				<scaleRotate enabled = "0">
					<scale min = "0.67" max = "1.5" />
					<rotate min = "-1.05" max = "1.05" />
				</scaleRotate>
				<gainBias enabled = "1">
					<gain min = "0.9" max = "1.1" />
					<bias min = "-5" max = "5" />
				</gainBias>
				<randomSearch enabled = "1">
					<radius val = "0.2" />
					<minRadius val = "0.01" />
					<scaleFactor val = "0.5" />
				</randomSearch>
			</gpm>
			<rmPunish val1 = "1.0" val2 = "1.0" />
			<guidanceWeight val1 = "1000.0" val2 = "1000" />
			<gtAsGuidance val = "0" />
			<poissonAlpha val = "1000" />
			<resPostfix val = "_syn_res.png" />
			<debug>
				<debugResult output = "1" dir = "syn//" />
				<cvShowResult val = "1" />
			</debug>
		</synthesis>

		<localColorCorrection>
			<patchRadius val = "10" />
			<correctionStepRatio val = "0.5" />
			<pyramid>
				<extraLevels val = "3" />
				<resizeRatio val = "0.5" />
			</pyramid>
			<resPostfix val = "_cor_res.png" />
			<TODOhandleMaterialnotExist />
		</localColorCorrection> 

		<patchRadius_old val = "3" />
	</recoveryStep>

</root>